---
title: "Total Health NVM Research"
description: |
  Voorbeeld11 with references to biblio.bib. 
author:
  - name: Edward Hillenaar
    url: https://edwardhill-th-distill.netlify.app
date: 2022-06-09
output:
  distill::distill_article:
    self_contained: false
    toc: true
    toc_depth: 3
bibliography: biblio.bib
preview: figures/featured.jpg
draft: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	error = FALSE,
	message = FALSE,
	warning = FALSE
)
```

```{css echo = FALSE}
  body {
    background-color: #dbe7ed;
}
```

# Introduction

Include reference in the text [@davis2007mindfulness]. This is another citation [@grosz2005bergson]. [@senez2004evaluation]
More: [@reid2010effects], [@van2008neuropathy]

En nog meer: [@kuipers1999standaard)

Alfred North Whitehead [@guide2003corrected]


![NVM Research](https://raw.githubusercontent.com/EdwardHill15/Data/main/graphs/bar1_t.png)

 * **punt 1**
 * **punt 2**
 * **punt 3**
 * **punt 4**
 
This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

# Results {.tabset}

## Data

```{r, echo = FALSE}
library(readr)
library(forcats)
library(tidyverse)
NVM1_Data <- read.csv("NVM1_Data.csv", header = TRUE, sep = ";")
NVM <- NVM1_Data
library(psych)
NVM <- NVM[,c(4:11)]
names(NVM) <- c("gender", "age", "status", "negativism", "somatization",
                "shyness", "psychopathology", "extraversion")
NVM <- na.omit(NVM)
NVM$consciousness <- ifelse(NVM$psychopathology >= 6, "unwholesome", 
                         ifelse(NVM$psychopathology < 2, "wholesome", "neutral"))

NVM$consciousness <- as.factor(NVM$consciousness)
NVM$gender <- as.factor(NVM$gender)
NVM$status <- as.factor(NVM$status)
NVM$age <- as.factor(NVM$age)

NVM$gender <- fct_recode(NVM$gender, female = "f", male = "m")

df_long <- gather(NVM, nvm_factor, score, c(4:6,8))
df_long <- df_long[-4]

df_long$nvm_factor <- as.factor(df_long$nvm_factor)

df_group_t <- group_by(df_long, consciousness, nvm_factor)

df_group_t <- group_by(df_long, consciousness, nvm_factor) %>% dplyr::summarise(mean=mean(score), sd=sd(score))


library(DT)
df_group_t$mean <- round(df_group_t$mean,2)
df_group_t$sd <- round(df_group_t$sd,2)
table1 <- datatable(df_group_t, extensions = "Buttons",
                    options = list(dom='Bfrtip',
                                   buttons = c('copy', 'csv', 'excel', 'pdf', 'print')))
table1

```


## Plots

You can also embed plots, for example:

```{r, echo = FALSE}
library(forcats)
library(plotly)
draw_key_polygon3 <- function(data, params, size) {
  lwd <- min(data$size, min(size) / 4)
  
  grid::rectGrob(
    width = grid::unit(0.6, "npc"),
    height = grid::unit(0.6, "npc"),
    gp = grid::gpar(
      col = data$colour,
      fill = alpha(data$fill, data$alpha),
      lty = data$linetype,
      lwd = lwd * .pt,
      linejoin = "mitre"
    ))
}

df_long$consciousness <- fct_reorder(df_long$consciousness, df_long$score)

df_long <- as.data.frame(df_long)

df_long$consciousness <- fct_relevel(df_long$consciousness, "unwholesome")

plot1 <- ggplot(df_long, aes(x=consciousness, y=score+1, fill = nvm_factor)) + 
  #geom_jitter(show.legend=FALSE, width=0.25, shape = 21) + 
  #geom_dotplot(binaxis = "y", binwidth = 0.1, stackdir = "center", 
  #show.legend = FALSE, col=I("black"), fill=I("grey")) +
  #facet_wrap(~bewustzijn) +
  geom_jitter(show.legend=FALSE, width=0.35, shape = 21, size = df_long$nvm_factor) +
  geom_boxplot(alpha = 0.9, width = 0.8, coef = 0.50, outlier.shape = NA) + 
  scale_fill_manual(values = c("#E4EBF2", "#84A45A", "#715E4E", "#112B04")) +
  #scale_fill_manual(values = c("#728CA3", "#73C0F4", "#E6EFF3")) +
  scale_y_continuous(expand = expansion(0),
                     limits = c(0, 40),
                     breaks = seq(0, 40, 10))
plot1

```

## Regression

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


